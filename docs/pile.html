<!DOCTYPE html>
<html>
<head>
<title>Piles</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css">
<script src="utils.js"></script>
</head>
<body>
<section class="section">
<h1 class="title">Les piles !</h1>
    <div class="columns">
    <div class="column">
  <article class="message is-info">
  <div class="message-header"><p>Instructions</p></div>
  <div class="message-body">
        <div class="content">
        Vous disposez d'une <strong>pile</strong>, pour l'instant vide, qui sera 
        compos√©e d'√©l√©ments pos√©s les uns sur les autres. 
        Vous pouvez la modifier de deux mani√®res :
        <ul>
        <li><strong>Ajouter</strong> un √©l√©ment <em>sur la pile</em>, tout en haut, on dit <strong>empiler</strong>.</li>
        <li><strong>D√©piler</strong>, c'est-√†-dire enlever l'√©l√©ment qui est <em>au sommet</em> de la pile.</li>
        </ul>
        </div>
        </div>
    </article>        
    </div>
    <div class="column">
        <article class="message is-success" id="entete-message">
            <div class="message-header">
                <p id="message">Sauriez-vous reconstituter la pile ci-dessous ?</p>
            </div>
            <div class="message-body">
                <form>  
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            Empiler
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="buttons" id="btn_empiler">
                                </div>
                            </div>
                            <div class="field-label is-normal">
                              ou
                            </div>
                            <div class="field-body">
                                <div id="btn_depiler" class="button is-success" onclick="enlever();">d√©piler</div>
                            </div> 
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <p class="help">Cliquez sur l'animal que vous souhaitez ajouter.</p> 
                    </div>           
                </form>
                <table  class="table mx-auto">
                    <thead>
                    <th>Votre pile</th>
                    <th>Objectif</th>
                    </thead>
                    <tbody>
                    <tr>
                    <td id="pile_essai" style="vertical-align: bottom;" ></td>
                    <td id="objectif" style="vertical-align: bottom;" ></td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </article>
        </div>
    </div>
</section>
<script>
liste_animaux = ["ü¶ë","ü™≤","üêº","ü¶ä","ü¶ê","ü¶Ü","üêØ","üê∏"];

creer_liste_boutons(liste_animaux,
                    "btn_empiler",
                    {"click":empiler,
                    "classes_btn":["has-background-success-light"],
                    "tag":"span"
                    });

var p = new Stack(
                    [],
                    {},
                    {"classes":["is-size-4"]});
p.draw(document.querySelector("#pile_essai"));


var pile_objectif = liste_animaux.sort(function () {
  return Math.random() - 0.5;
});
pile_objectif = pile_objectif.slice(-5);
var q = new Stack(pile_objectif,{},{"classes":["has-text-centered","is-size-4"]});
q.draw(document.querySelector("#objectif"));


function verifier(){
    var boutons = document.querySelector("#btn_empiler").getElementsByClassName("button");
    if (q.is_equal_to(p)){
        document.getElementById("message").innerHTML = "BRAVO ! Rechargez la page pour avoir une nouvelle pile.";
        document.getElementById("entete-message").classList.remove("is-success");
        document.getElementById("entete-message").classList.add("is-danger");
/*
        for(var j in q.list){
            q.remove_class_item(j,"has-background-success-light");
            q.add_class_item(j,"has-background-danger-light");
        }
        for(var j in p.list){
            p.remove_class_item(j,"has-background-success-light");
            p.add_class_item(j,"has-background-danger-light");
        }
*/     
        for(var j = 0 ; j < boutons.length ;j++){
            boutons[j].classList.remove("has-background-success-light");
            boutons[j].classList.add("has-background-danger-light");
        }
        document.querySelector("#btn_depiler").classList.remove("is-success");
        document.querySelector("#btn_depiler").classList.add("is-danger");

    }else{
        document.getElementById("message").innerHTML = "Sauriez-vous reconstituter la pile ci-dessous ?";
        document.getElementById("entete-message").classList.add("is-success");
        document.getElementById("entete-message").classList.remove("is-danger");

/*
        for(var j in q.list){
            q.add_class_item(j,"has-background-success-light");
            q.remove_class_item(j,"has-background-danger-light");
        }
        for(var j in p.list){
            p.add_class_item(j,"has-background-success-light");
            p.remove_class_item(j,"has-background-danger-light");
        }
*/
        
        for(var j = 0 ; j < boutons.length ;j++){
            boutons[j].classList.add("has-background-success-light");
            boutons[j].classList.remove("has-background-danger-light");
        }
        document.querySelector("#btn_depiler").classList.add("is-success");
        document.querySelector("#btn_depiler").classList.remove("is-danger");
    }
}

function empiler(elt){
    var value = elt.target.dataset.value;
    if(value.length > 0){
        p.push(value);
        p.draw();
        verifier();
    }
}
function enlever(){
    p.pop();
    p.draw();
    verifier();
}

</script>
</body>
</html>
